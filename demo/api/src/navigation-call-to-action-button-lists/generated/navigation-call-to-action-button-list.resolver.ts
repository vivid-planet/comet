// This file has been generated by comet api-generator.
// You may choose to use this file as scaffold by moving this file out of generated folder and removing this comment.
import { EntityManager } from "@mikro-orm/postgresql";
import { Args, Mutation, Query, Resolver } from "@nestjs/graphql";
import { RequiredPermission } from "@comet/cms-api";
import { NavigationCallToActionButtonList } from "../entities/navigation-call-to-action-button-list.entity";
import { NavigationCallToActionButtonListScope } from "../dto/navigation-call-to-action-button-list-scope";
import { NavigationCallToActionButtonListsService } from "./navigation-call-to-action-button-lists.service";
import { NavigationCallToActionButtonListInput } from "./dto/navigation-call-to-action-button-list.input";
@Resolver(() => NavigationCallToActionButtonList)
@RequiredPermission("pageTree")
export class NavigationCallToActionButtonListResolver {
    constructor(
        protected readonly entityManager: EntityManager,
        protected readonly navigationCallToActionButtonListsService: NavigationCallToActionButtonListsService,
    ) {}
    @Query(() => NavigationCallToActionButtonList, { nullable: true })
    async navigationCallToActionButtonList(
        @Args("scope", { type: () => NavigationCallToActionButtonListScope })
        scope: NavigationCallToActionButtonListScope,
    ): Promise<NavigationCallToActionButtonList | null> {
        const navigationCallToActionButtonLists = await this.entityManager.find(NavigationCallToActionButtonList, { scope });
        if (navigationCallToActionButtonLists.length > 1) {
            throw new Error("There must be only one navigationCallToActionButtonList");
        }
        return navigationCallToActionButtonLists.length > 0 ? navigationCallToActionButtonLists[0] : null;
    }
    @Mutation(() => NavigationCallToActionButtonList)
    async saveNavigationCallToActionButtonList(
        @Args("scope", { type: () => NavigationCallToActionButtonListScope })
        scope: NavigationCallToActionButtonListScope,
        @Args("input", { type: () => NavigationCallToActionButtonListInput })
        input: NavigationCallToActionButtonListInput,
    ): Promise<NavigationCallToActionButtonList> {
        let navigationCallToActionButtonList = await this.entityManager.findOne(NavigationCallToActionButtonList, { scope });
        if (!navigationCallToActionButtonList) {
            navigationCallToActionButtonList = this.entityManager.create(NavigationCallToActionButtonList, {
                ...input,
                content: input.content.transformToBlockData(),
                scope,
            });
        }
        navigationCallToActionButtonList.assign({
            ...input,
            content: input.content.transformToBlockData(),
        });
        await this.entityManager.flush();
        return navigationCallToActionButtonList;
    }
}
